# LanMicBridge

同一LAN内のPC間で音声を送受信するための軽量ブリッジ。  
マイク入力をUDPで送信し、受信側の出力デバイスへ低遅延で再生します。

## 特長
- 同一LAN内の音声転送に特化
- 低遅延/安定を調整可能（ジッタバッファ/プリバッファ）
- Opusエンコード対応（品質調整）
- 送受信ともに音量/AGC/ゲート調整
- 設定の保存/復元
- PCM直送モード（デバッグ用途）

## 構成図
```mermaid
flowchart LR
    A[送信側 マイク入力] -->|WASAPI/MME| B[前処理<br/>AGC/ゲート/ゲイン]
    B --> C[Opus/PCM エンコード]
    C -->|UDP| D[受信側 ジッタバッファ]
    D --> E[デコード/補間]
    E --> F[後処理<br/>AGC/ゲート/ゲイン]
    F --> G[出力デバイス]
```

## 使い方（概要）
1. 受信側で起動し、表示されたIPを確認
2. 送信側で受信側IPを入力して送信開始
3. 受信側の出力デバイスを選択して再生

## 設定タブの概要
### 受信
- 出力デバイス: 再生先（仮想ケーブルや物理スピーカー等）
- ジッタバッファ: 低遅延/安定性のバランス
- 音声処理: 受信側AGC/ゲート/クリップ
- 出力ゲイン: 出力音量の補正
- 強制再生待ち: 少量入力時の待機時間
- チェック音: ループバック確認

### 送信
- 入力方式: WASAPI / MME
- マイクデバイス: 送信元マイク選択
- 送信品質: 低/標準/高/超高
- 送信方式: Opus / PCM直送(テスト)
- 送信ゲイン: 入力音量の補正
- 送信開始閾値: VAD（小音量の扱い）
- 音声処理: 送信側AGC/ゲート/クリップ

### 情報
- 音量（Peak/RMS）
- 出力後レベル
- パケット統計（Loss/Jitter/Delay）
- ガイド/警告

## FAQ
**Q. 小さい声が拾われません。**  
送信開始閾値（VAD）を下げてください。目安は `-55 ~ -70 dBFS`。  
加えて送信ゲインを上げると改善します。

**Q. 音が途切れます。**  
受信側ジッタバッファを「Stable」または「Ultra stable」に上げてください。  
LANの混雑やWi‑Fi環境で改善します。

**Q. 遅延を減らしたいです。**  
ジッタバッファを「Low latency」に。  
強制再生待ちを短くするのも有効です（0.5s〜1.0s）。

**Q. 音が小さいです。**  
受信側の出力ゲインを上げてください。  
送信側の送信ゲインも併用すると安定します。

**Q. 送信品質の違いは？**  
高/超高は帯域を使う分、音質が向上します。  
LAN内で帯域に余裕があるなら「超高」がおすすめです。

**Q. PCM直送(テスト)は何ですか？**  
Opusを使わず生PCMで送るデバッグモードです。  
帯域を多く使うため通常はOpus推奨です。

**Q. 入力方式（WASAPI/MME）の違いは？**  
WASAPIが推奨。MMEは互換性重視で遅延が増える場合があります。

**Q. 音声処理(AGC/ゲート/クリップ)はONがいい？**  
基本はON推奨。  
原音のまま送りたい場合はOFFで確認してください。

**Q. チェック音がFAILになります。**  
出力デバイスが正しく選べているか確認してください。  
仮想ケーブル使用時は「出力先」と「入力先」が一致している必要があります。

## 動作環境
- Windows 10 / 11
- .NET 8
- 同一LAN環境

## ライセンス
MIT License  
詳しくは `LICENSE` を参照してください。

## 問い合わせ
X: `@route20191212`
